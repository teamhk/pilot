<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hk.pilot.mapper.ManagerMapper">

<select id="memberList" resultType="com.hk.pilot.dto.Member">
	SELECT * FROM MEMBERS
</select>

<select id="pwdCheck" parameterType ="String" resultType="com.hk.pilot.dto.Member">
	SELECT * FROM MEMBERS where id=#{id} and pwd=#{pwd}
</select>

<insert id="storeAdd">
	INSERT INTO STORES (ID, SNAME, SADDRESS, SCONTACT, SNUM, BANK, BNUM, SDCHECK, AREA_NUM) 
	VALUES(#{id}, #{sname}, #{saddress}, #{scontact}, #{snum}, #{bank}, #{bnum}, '0', #{area_num})
</insert>


<insert id="itemListAdd">
	INSERT INTO ITEMLIST (SNUM, SHIRT, BLOUSE, T_SHIRT) 
	VALUES(#{snum}, #{shirt}, #{blouse}, #{t_shirt})
</insert>

<select id="myStoresList" resultType="com.hk.pilot.dto.Stores">
	SELECT * FROM STORES WHERE ID=#{ID} AND SDCHECK='0'
</select>

<select id="selectStoreOne" parameterType ="String" resultType="com.hk.pilot.dto.StoreInfo">
	SELECT s.ID , s.SNAME , s.SADDRESS, i.snum, scontact,bank, bnum,permit,s_date,area_num,t_shirt,shirt,blouse FROM ITEMLIST i,STORES s WHERE i.SNUM = s.SNUM AND i.snum=#{snum}
</select>

<update id="storeUpdate" parameterType="com.hk.pilot.dto.StoreInfo">
	UPDATE STORES SET SNAME=#{sname}, SADDRESS=#{saddress}, SCONTACT=#{scontact}, BANK=#{bank}, BNUM=#{bnum}, AREA_NUM=#{area_num} WHERE SNUM=#{snum}
</update>

<update id="itemListUpdate" parameterType="com.hk.pilot.dto.StoreInfo">
	UPDATE ITEMLIST SET SHIRT=#{shirt}, BLOUSE=#{blouse}, T_SHIRT=#{t_shirt} WHERE SNUM=#{snum}
</update>

<update id="storeDelete">
	UPDATE STORES SET sdcheck='1' where SNUM=#{snum}
</update>

<select id="selectMemberOne" resultType="com.hk.pilot.dto.Member">
	SELECT * FROM MEMBERS WHERE ID=#{ID}
</select>

<update id="ownerUpdate" parameterType="com.hk.pilot.dto.Member">
	UPDATE MEMBERS SET NAME=#{name}, PWD=#{pwd}, EMAIL=#{email}, ADDRESS=#{address}, PNUM=#{pnum}, PWQUESTION=#{pwQuestion}, PWANSWER=#{pwAnswer}, GRADE='2' WHERE ID=#{id}
</update>

<update id="ownerDeleterPost" parameterType="String">
	UPDATE MEMBERS SET UDCHECK='1' where ID=#{id}	
</update>

<select id="managerOrderList" resultType="com.hk.pilot.dto.OrderProcess">
	SELECT o.ORDERNUM, o.ID , o.SNUM , o.SNAME , o.PAY_DATE , o.PAY_PRICE , o.R_CHECK , o.BUBBLE , o.BLOUSE , o.SHIRT , o.T_SHIRT , m.NAME,m.ADDRESS , m.PNUM ,p.WAIT ,p.OK , p.PICK , p.WASH , p.FINISH, o.items FROM ORDERLIST o , MEMBERS m , PROCESS p WHERE o.ORDERNUM = p.ORDERNUM AND o.ID = m.ID AND snum=#{snum}
</select>

<select id="managerOrderInfo" resultType="com.hk.pilot.dto.OrderProcess">
	SELECT o.ORDERNUM, o.ID , o.SNUM , o.SNAME , o.PAY_DATE , o.PAY_PRICE , o.R_CHECK , o.BUBBLE , o.BLOUSE , o.SHIRT , o.T_SHIRT , m.NAME,m.ADDRESS , m.PNUM ,p.WAIT ,p.OK , p.PICK , p.WASH , p.FINISH, o.items FROM ORDERLIST o , MEMBERS m , PROCESS p WHERE o.ORDERNUM = p.ORDERNUM AND o.ID = m.ID AND o.ORDERNUM=#{orderNum}
</select>

<update id="managerProcess">
	UPDATE PROCESS SET 
	<choose>
    <when test="process != null and process.equals('접수중')">
      WAIT=sysdate
    </when>
    <when test="process != null and process.equals('접수완료')">
      OK=sysdate
    </when>
    <when test="process != null and process.equals('수거완료')">
      PICK=sysdate
    </when>
    <when test="process != null and process.equals('세탁중')">
      WASH=sysdate
    </when>
    <when test="process != null and process.equals('배달완료')">
      FINISH=sysdate
    </when>
    <otherwise>
    </otherwise>
  </choose>
	WHERE ORDERNUM=#{orderNum}
</update>

</mapper>